{
  "name": "AI Lead Processing Agent",
  "nodes": [
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1sfOA5102rWMMs34_F3QTIaD1v9_N0w6tAzjA5R-w72c/edit?usp=sharing",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–õ–∏—Å—Ç1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sfOA5102rWMMs34_F3QTIaD1v9_N0w6tAzjA5R-w72c/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "–î–∞—Ç–∞": "={{ $('Extract Contacts').item.json.extracted.date }}",
            "–ò–º—è": "={{ $('Extract Contacts').item.json.extracted.firstName }}",
            "username": "={{ $('Extract Contacts').item.json.extracted.username }}",
            "–°–æ–æ–±—â–µ–Ω–∏–µ": "={{ $('Extract Contacts').item.json.extracted.originalMessage }}",
            "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞": "={{ $('Extract Contacts').item.json.temperature }}",
            "–ü—Ä–∏—á–∏–Ω–∞": "={{ $('Extract Contacts').item.json.reason }}",
            "–¢–µ–ª–µ—Ñ–æ–Ω": "={{ $('Extract Contacts').item.json.extracted.phone }}",
            "Email": "={{ $('Extract Contacts').item.json.extracted.email }}",
            "–°—Ç–∞—Ç—É—Å": "–ù–æ–≤—ã–π",
            "–ò—Å—Ç–æ—á–Ω–∏–∫": "={{ $('Extract Contacts').item.json.extracted.source }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "–î–∞—Ç–∞",
              "displayName": "–î–∞—Ç–∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–ò–º—è",
              "displayName": "–ò–º—è",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "username",
              "displayName": "username",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–°–æ–æ–±—â–µ–Ω–∏–µ",
              "displayName": "–°–æ–æ–±—â–µ–Ω–∏–µ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞",
              "displayName": "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–ü—Ä–∏—á–∏–Ω–∞",
              "displayName": "–ü—Ä–∏—á–∏–Ω–∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–¢–µ–ª–µ—Ñ–æ–Ω",
              "displayName": "–¢–µ–ª–µ—Ñ–æ–Ω",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "–°—Ç–∞—Ç—É—Å",
              "displayName": "–°—Ç–∞—Ç—É—Å",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "–ò—Å—Ç–æ—á–Ω–∏–∫",
              "displayName": "–ò—Å—Ç–æ—á–Ω–∏–∫",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1600,
        -608
      ],
      "id": "7cb314ca-e695-4515-b078-6211f9856a5c",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "J9i793A3S5vdil3F",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.groq.com/openai/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json.body) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -176,
        -640
      ],
      "id": "35a3b382-3aea-4b6c-bbae-abbe091294f2",
      "name": "HTTP Request",
      "credentials": {
        "httpHeaderAuth": {
          "id": "Q42fDDKqNr2ZATsH",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "02f94f1f-132f-49e8-9b83-80f27f878094",
              "name": "userMessage",
              "value": "={{ $json.message?.text || $json.callback_query?.data || '' }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1616,
        -768
      ],
      "id": "6aecaf52-4092-46eb-9df9-049850032249",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsCode": "const input = $input.first().json;\nconst userMessage = input.message?.text || input.callback_query?.data || '';\n\nconst companyName = \"WebPro Studio\";\nconst businessType = \"—Å–æ–∑–¥–∞–Ω–∏–µ —Å–∞–π—Ç–æ–≤ –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π\";\nconst managerName = \"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä\";\nconst responseTime = \"–≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç\";\nconst workingHoursStart = 9;\nconst workingHoursEnd = 18;\nconst timezone = 3;\n\nconst now = new Date();\nconst localHour = (now.getUTCHours() + timezone) % 24;\nconst dayOfWeek = now.getUTCDay();\nconst isWeekend = dayOfWeek === 0 || dayOfWeek === 6;\nconst isWorkingHours = localHour >= workingHoursStart && localHour < workingHoursEnd && !isWeekend;\n\nconst timeInstruction = isWorkingHours \n  ? `–ú–µ–Ω–µ–¥–∂–µ—Ä ${managerName} —Å–≤—è–∂–µ—Ç—Å—è ${responseTime}.`\n  : `–°–µ–π—á–∞—Å –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è. –ú–µ–Ω–µ–¥–∂–µ—Ä ${managerName} —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ —Ä–∞–±–æ—á–∏–µ —á–∞—Å—ã (–ü–Ω-–ü—Ç ${workingHoursStart}:00-${workingHoursEnd}:00 –ú–°–ö).`;\n\nconst systemPrompt = `–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∫–æ–º–ø–∞–Ω–∏–∏ \"${companyName}\".\n–ú—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è: ${businessType}.\n–ú–µ–Ω–µ–¥–∂–µ—Ä–∞ –∑–æ–≤—É—Ç: ${managerName}.\n\n–¢–í–û–Ø –ó–ê–î–ê–ß–ê: –æ–ø—Ä–µ–¥–µ–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –ª–∏–¥–∞ –∏ –Ω–∞–ø–∏—à–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É.\n\n–¢–ï–ú–ü–ï–†–ê–¢–£–†–ê:\n- HOT = –æ—Å—Ç–∞–≤–∏–ª –∫–æ–Ω—Ç–∞–∫—Ç—ã (—Ç–µ–ª–µ—Ñ–æ–Ω, –∏–º—è), —Ö–æ—á–µ—Ç –∫—É–ø–∏—Ç—å, –∑–∞–∫–∞–∑–∞—Ç—å, —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ü–µ–Ω—É\n- WARM = –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç—Å—è, –∑–∞–¥–∞—ë—Ç –≤–æ–ø—Ä–æ—Å—ã –æ —É—Å–ª—É–≥–∞—Ö, —Ö–æ—á–µ—Ç —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ\n- COLD = –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, /start, —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\n\n–í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:\n1. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –£–ñ–ï –æ—Å—Ç–∞–≤–∏–ª —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, —á—Ç–æ —Ö–æ—á–µ—Ç) ‚Äî –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ –∏ —Å–∫–∞–∂–∏ —á—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è. –ù–ï –ø—Ä–æ—Å–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ!\n2. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Ç–æ–ª—å–∫–æ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç ‚Äî –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã\n3. –ü–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫\n4. –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –æ—Ç–≤–µ—Ç–µ (–Ω–µ –ø–∏—à–∏ –µ–≥–æ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ)\n\n–ü–†–ò–ú–ï–†–´:\n\n–ö–ª–∏–µ–Ω—Ç: \"–ê–Ω–Ω–∞, —Ö–æ—á—É —Å–∞–π—Ç, +7 999 123 45 67\"\n–û—Ç–≤–µ—Ç: \"–°–ø–∞—Å–∏–±–æ, –ê–Ω–Ω–∞! –ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞. ${timeInstruction}\"\n\n–ö–ª–∏–µ–Ω—Ç: \"–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ª–µ–Ω–¥–∏–Ω–≥?\"\n–û—Ç–≤–µ—Ç: \"–°—Ç–æ–∏–º–æ—Å—Ç—å –ª–µ–Ω–¥–∏–Ω–≥–∞ –æ—Ç 30 000 ‚ÇΩ, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. –û—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–∞—Å—Å–∫–∞–∂–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–µ–µ –∏ —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç —Ç–æ—á–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å.\"\n\n–ö–ª–∏–µ–Ω—Ç: \"–ü—Ä–∏–≤–µ—Ç\"\n–û—Ç–≤–µ—Ç: \"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –ø–æ–º–æ—â–Ω–∏–∫ ${companyName}. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?\"\n\n–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê (—Å—Ç—Ä–æ–≥–æ JSON):\n{\"temperature\": \"HOT\", \"reason\": \"–∫—Ä–∞—Ç–∫–∞—è –ø—Ä–∏—á–∏–Ω–∞\", \"reply\": \"—Ç–≤–æ–π –æ—Ç–≤–µ—Ç\"}`;\n\nreturn [{\n  json: {\n    body: {\n      model: \"llama-3.1-8b-instant\",\n      messages: [\n        { role: \"system\", content: systemPrompt },\n        { role: \"user\", content: userMessage }\n      ]\n    },\n    originalMessage: userMessage,\n    isWorkingHours: isWorkingHours\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -352,
        -640
      ],
      "id": "19a92686-fc3f-4552-b678-2694e7e325f7",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "53b1f790-6bef-4b54-aecd-48eaa64894bf",
              "leftValue": "={{ $json.temperature }}",
              "rightValue": "COLD",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        816,
        -656
      ],
      "id": "d60f6c3e-0365-4c64-922d-a0e69f882941",
      "name": "If"
    },
    {
      "parameters": {
        "jsCode": "const response = $input.first().json;\n\nlet temperature = 'COLD';\nlet reason = '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å';\nlet reply = '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –°–ø–∞—Å–∏–±–æ –∑–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ. –ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.';\n\ntry {\n  const content = response.choices[0].message.content;\n  const jsonMatch = content.match(/\\{[\\s\\S]*\\}/);\n  \n  if (jsonMatch) {\n    const parsed = JSON.parse(jsonMatch[0]);\n    \n    if (parsed.temperature && ['HOT', 'WARM', 'COLD'].includes(parsed.temperature.toUpperCase())) {\n      temperature = parsed.temperature.toUpperCase();\n    }\n    \n    if (parsed.reason) {\n      reason = parsed.reason;\n    }\n    \n    if (parsed.reply) {\n      reply = parsed.reply;\n    }\n  }\n} catch (error) {\n  console.log('Parse error:', error.message);\n}\n\nreturn [{\n  json: {\n    temperature: temperature,\n    reason: reason,\n    reply: reply,\n    originalResponse: response\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        -640
      ],
      "id": "99543b25-fe3d-4092-8e0b-e1aade05e6cf",
      "name": "Parse Response"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $('Start Trigger1').item.json.message.chat.id }},\n  \"text\": \"{{ $('Parse Response').item.json.reply }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1280,
        -576
      ],
      "id": "0772cf96-7363-469f-9bb1-3c111b903b4f",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": 477704730,\n  \"text\": \"{{ $('Extract Contacts').item.json.temperature === 'HOT' ? 'üî• –ì–û–†–Ø–ß–ò–ô –õ–ò–î!' : 'üå§ –¢–Å–ü–õ–´–ô –õ–ò–î' }}\\n\\nüë§ –ò–º—è: {{ $('Extract Contacts').item.json.extracted.firstName }}\\nüì± Username: @{{ $('Extract Contacts').item.json.extracted.username }}\\nüÜî User ID: {{ $('Extract Contacts').item.json.extracted.userId }}{{ $('Extract Contacts').item.json.extracted.phone ? '\\n\\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: ' + $('Extract Contacts').item.json.extracted.phone : '' }}{{ $('Extract Contacts').item.json.extracted.email ? '\\nüìß Email: ' + $('Extract Contacts').item.json.extracted.email : '' }}\\n\\nüí¨ –°–æ–æ–±—â–µ–Ω–∏–µ: {{ $('Extract Contacts').item.json.extracted.originalMessage }}\\n\\nüå° –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {{ $('Extract Contacts').item.json.temperature }}\\nüìù –ü—Ä–∏—á–∏–Ω–∞: {{ $('Extract Contacts').item.json.reason }}\\n\\n‚è∞ {{ $('Extract Contacts').item.json.extracted.date }} {{ $('Extract Contacts').item.json.extracted.time }}\",\n  \"reply_markup\": {\n    \"inline_keyboard\": [[{\"text\": \"üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—É\", \"url\": \"https://t.me/{{ $('Extract Contacts').item.json.extracted.username }}\"}]]\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1008,
        -896
      ],
      "id": "a76b5ade-473d-4341-87a9-e73d91b35a0b",
      "name": "Notify Owner"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "d3d8c6e7-310b-476a-8d47-a0b3d1baa610",
              "leftValue": "={{ $json.message?.text || '' }}",
              "rightValue": "/start",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -2000,
        -864
      ],
      "id": "438e582d-0dfc-4d06-8820-5a39931b283f",
      "name": "If1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.message.chat.id }},\n  \"text\": \"üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ WebPro Studio!\\n\\nüöÄ –ú—ã —Å–æ–∑–¥–∞—ë–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∞–π—Ç—ã –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.\\n\\nüìå –ù–∞—à–∏ —É—Å–ª—É–≥–∏:\\n‚Ä¢ –õ–µ–Ω–¥–∏–Ω–≥–∏ ‚Äî –æ—Ç 30 000 ‚ÇΩ\\n‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∞–π—Ç—ã ‚Äî –æ—Ç 60 000 ‚ÇΩ\\n‚Ä¢ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω—ã ‚Äî –æ—Ç 100 000 ‚ÇΩ\\n‚Ä¢ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –ø–æ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏\\n\\nüïê –†–∞–±–æ—á–∏–µ —á–∞—Å—ã: –ü–Ω-–ü—Ç 9:00-18:00 (–ú–°–ö)\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ üëá\",\n  \"reply_markup\": {\n    \"inline_keyboard\": [\n      [{\"text\": \"üìù –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É\", \"callback_data\": \"request\"}],\n      [{\"text\": \"üí∞ –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ü–µ–Ω–∞—Ö\", \"callback_data\": \"prices\"}],\n      [{\"text\": \"üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã\", \"callback_data\": \"contact\"}, {\"text\": \"üñº –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ\", \"callback_data\": \"portfolio\"}]\n    ]\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1792,
        -1024
      ],
      "id": "3b81f30c-6cbd-47ee-a402-90ad51738377",
      "name": "Welcome Message"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.callback_query.data }}",
                    "rightValue": "prices",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "2166d416-449c-49bd-b3f6-5914c7ba4d07"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "prices"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "e0113dd0-037b-4a6b-8cad-137867a99eff",
                    "leftValue": "={{ $json.callback_query.data }}",
                    "rightValue": "contact",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "contact"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "56a4d719-e2de-4e66-b4f9-53e7a297c452",
                    "leftValue": "={{ $json.callback_query.data }}",
                    "rightValue": "portfolio",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "portfolio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d3a78422-4964-4554-a982-98754ad877f7",
                    "leftValue": "={{ $json.callback_query.data }}",
                    "rightValue": "request",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "request"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -1440,
        80
      ],
      "id": "1e69da23-9029-4d18-9753-9bebe3b393b8",
      "name": "Switch"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.callback_query.from.id }},\n  \"text\": \"üí∞ –ù–∞—à–∏ —Ü–µ–Ω—ã:\\n\\n‚Ä¢ –õ–µ–Ω–¥–∏–Ω–≥ ‚Äî –æ—Ç 30 000 ‚ÇΩ\\n‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∞–π—Ç ‚Äî –æ—Ç 60 000 ‚ÇΩ\\n‚Ä¢ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω ‚Äî –æ—Ç 100 000 ‚ÇΩ\\n‚Ä¢ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –ø–æ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏\\n\\nüìû –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞!\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -704,
        -128
      ],
      "id": "42b89c4f-8d86-4b57-a217-074235a04526",
      "name": "Price Response"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.callback_query.from.id }},\n  \"text\": \"üí∞ –ù–∞—à–∏ —Ü–µ–Ω—ã:\\n\\n‚Ä¢ –õ–µ–Ω–¥–∏–Ω–≥ ‚Äî –æ—Ç 30 000 ‚ÇΩ\\n‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∞–π—Ç ‚Äî –æ—Ç 60 000 ‚ÇΩ\\n‚Ä¢ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω ‚Äî –æ—Ç 100 000 ‚ÇΩ\\n‚Ä¢ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –ø–æ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏\\n\\nüìû –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞!\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -720,
        64
      ],
      "id": "d3c328a0-24fc-4d34-94b3-8cd3e638f45c",
      "name": "Contact Response"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.callback_query.from.id }},\n  \"text\": \"üñº –ù–∞—à–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ:\\n\\nüîó webpro.studio/portfolio\\n\\n–ù–∞—à–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞–±–æ—Ç—ã:\\n‚Ä¢ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –æ–¥–µ–∂–¥—ã\\n‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Å–∞–π—Ç IT-–∫–æ–º–ø–∞–Ω–∏–∏\\n‚Ä¢ –õ–µ–Ω–¥–∏–Ω–≥ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å–æ–≤\\n\\n–•–æ—Ç–∏—Ç–µ –æ–±—Å—É–¥–∏—Ç—å –ø–æ—Ö–æ–∂–∏–π –ø—Ä–æ–µ–∫—Ç?\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -720,
        272
      ],
      "id": "98edf183-4a05-4c8b-a6a0-67a69112db10",
      "name": "Portfolio Response"
    },
    {
      "parameters": {
        "updates": [
          "callback_query"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -2240,
        96
      ],
      "id": "4dc32fcd-3fe2-4c59-adc4-e539a8b0a43d",
      "name": "Telegram Trigger1",
      "webhookId": "b1ff1265-e9cf-46d6-89ff-a4cbb3bda4a4",
      "credentials": {
        "telegramApi": {
          "id": "ck0yCtHyUy19KDj6",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -2272,
        -864
      ],
      "id": "71e6cff5-552c-4be8-b74b-0e987c3812b7",
      "name": "Start Trigger1",
      "webhookId": "795f237a-9041-4470-b0e4-1aa872ebfb19",
      "credentials": {
        "telegramApi": {
          "id": "ck0yCtHyUy19KDj6",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const input = $input.first().json;\n\nconst editFieldsData = $('Edit Fields').first().json;\nconst userMessage = editFieldsData.userMessage || editFieldsData.message?.text || '';\n\nconst userData = editFieldsData.message?.from || {};\nconst chatData = editFieldsData.message?.chat || {};\n\nconst phoneRegex = /(?:\\+7|8|7)?[\\s\\-]?\\(?[0-9]{3}\\)?[\\s\\-]?[0-9]{3}[\\s\\-]?[0-9]{2}[\\s\\-]?[0-9]{2}|(?:\\+?[0-9]{10,15})/g;\nconst phones = userMessage.match(phoneRegex);\nconst phone = phones ? phones[0].replace(/[\\s\\-\\(\\)]/g, '') : '';\n\nconst emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/g;\nconst emails = userMessage.match(emailRegex);\nconst email = emails ? emails[0] : '';\n\nconst now = new Date();\nconst moscowOffset = 3 * 60 * 60 * 1000;\nconst moscowTime = new Date(now.getTime() + moscowOffset);\n\nconst date = moscowTime.toISOString().split('T')[0];\nconst time = moscowTime.toISOString().split('T')[1].substring(0, 5);\n\nlet source = '–°–æ–æ–±—â–µ–Ω–∏–µ';\nif (userMessage === '/start') {\n  source = '–ö–æ–º–∞–Ω–¥–∞ /start';\n} else if (userMessage === 'prices' || userMessage === 'contact' || userMessage === 'portfolio' || userMessage === 'request') {\n  source = '–ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é';\n}\n\nconst cleanMessage = userMessage.replace(/\\n/g, ' ').replace(/\"/g, \"'\").substring(0, 200);\n\nreturn [{\n  json: {\n    temperature: input.temperature,\n    reason: input.reason,\n    reply: input.reply,\n    extracted: {\n      phone: phone,\n      email: email,\n      date: date,\n      time: time,\n      userId: userData.id || chatData.id || '',\n      firstName: userData.first_name || chatData.first_name || '',\n      username: userData.username || chatData.username || '',\n      originalMessage: cleanMessage,\n      source: source\n    }\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        160,
        -640
      ],
      "id": "77bd80a0-f006-4a2f-9b95-4ecf482ea506",
      "name": "Extract Contacts"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.callback_query.from.id }},\n  \"text\": \"üìù –û—Ç–ª–∏—á–Ω–æ! –ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É, –Ω–∞–ø–∏—à–∏—Ç–µ:\\n\\n1Ô∏è‚É£ –í–∞—à–µ –∏–º—è\\n2Ô∏è‚É£ –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç (–ª–µ–Ω–¥–∏–Ω–≥, —Å–∞–π—Ç, –º–∞–≥–∞–∑–∏–Ω)\\n3Ô∏è‚É£ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —Å–≤—è–∑–∏\\n\\n–ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è! üöÄ\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -704,
        528
      ],
      "id": "9cfbdeda-f294-4207-82e2-1d4d53afed4c",
      "name": "Request Response"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": 477704730,\n  \"text\": \"üìù –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê!\\n\\nüë§ –ò–º—è: {{ $json.callback_query.from.first_name }}\\nüì± Username: @{{ $json.callback_query.from.username }}\\nüÜî User ID: {{ $json.callback_query.from.id }}\\n\\n‚è∞ –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É '–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É'\\n\\nüìû –û–∂–∏–¥–∞–π —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏!\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -368,
        512
      ],
      "id": "40c18d90-a869-4241-aadf-914324942b06",
      "name": "Notify Request"
    },
    {
      "parameters": {
        "jsCode": "const message = $input.first().json;\nconst userId = message.message?.from?.id || message.message?.chat?.id || 0;\nconst userMessage = message.message?.text || '';\n\nif (userMessage === '/start') {\n  return [{\n    json: {\n      ...message,\n      isSpam: false,\n      spamReason: ''\n    }\n  }];\n}\n\nif (userMessage.length > 1000) {\n  return [{\n    json: {\n      ...message,\n      isSpam: true,\n      spamReason: '–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ'\n    }\n  }];\n}\n\nconst urlRegex = /(https?:\\/\\/[^\\s]+)/g;\nconst urls = userMessage.match(urlRegex) || [];\nif (urls.length > 2) {\n  return [{\n    json: {\n      ...message,\n      isSpam: true,\n      spamReason: '–ú–Ω–æ–≥–æ —Å—Å—ã–ª–æ–∫'\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    ...message,\n    isSpam: false,\n    spamReason: ''\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -736,
        -688
      ],
      "id": "85f3d9ed-6e79-4d13-868d-49640f11c7d0",
      "name": "Spam Check"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "93b9bce2-7ef6-48c0-a13f-026b101e6f05",
              "leftValue": "={{ $json.isSpam }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -512,
        -880
      ],
      "id": "07710071-8f90-4627-b971-16e8e999ef81",
      "name": "Is Spam"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "175c0945-2ae5-4749-b7a9-36700934733b",
              "leftValue": "={{ $json.extracted.phone }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        352,
        -640
      ],
      "id": "cfc70719-9f74-4468-8c6b-0d3fee6279ba",
      "name": "Has Phone"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $('Edit Fields').item.json.message.chat.id }},\n  \"text\": \"üìû –°–ø–∞—Å–∏–±–æ! –í–∞—à –Ω–æ–º–µ—Ä {{ $json.extracted.phone }} –ø–æ–ª—É—á–µ–Ω.\\n\\n–ú–µ–Ω–µ–¥–∂–µ—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç –≤–∞–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è! üöÄ\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        544,
        -960
      ],
      "id": "651bc2e0-b383-4764-b84e-8ee8d99c2275",
      "name": "Thank You Message"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "04634be0-1129-4841-bed9-afaadad4f711",
              "leftValue": "={{ $json.message.voice ? 'true' : 'false' }}",
              "rightValue": "true",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -1232,
        -688
      ],
      "id": "15504919-4dad-404e-a14a-d42eae51c26e",
      "name": "Is Voice"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot7860770360:AAEcCU2YAEgG6hrE52wJNxUtPCQGjDCwSQE/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"chat_id\": {{ $json.message.chat.id }},\n  \"text\": \"üé§ –°–ø–∞—Å–∏–±–æ –∑–∞ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!\\n\\n–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –ø–æ–∫–∞ –Ω–µ —É–º–µ—é –∏—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–º:\\n\\n1Ô∏è‚É£ –í–∞—à–µ –∏–º—è\\n2Ô∏è‚É£ –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç\\n3Ô∏è‚É£ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\\n\\n–ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ üëá\",\n  \"reply_markup\": {\n    \"inline_keyboard\": [[{\"text\": \"üìù –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É\", \"callback_data\": \"request\"}]]\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -992,
        -864
      ],
      "id": "1175988e-5f04-4c5d-9132-d660cf313d17",
      "name": "Voice Reply"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1sfOA5102rWMMs34_F3QTIaD1v9_N0w6tAzjA5R-w72c/edit?gid=879270918#gid=879270918",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 879270918,
          "mode": "list",
          "cachedResultName": "Messages History",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1sfOA5102rWMMs34_F3QTIaD1v9_N0w6tAzjA5R-w72c/edit#gid=879270918"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "–î–∞—Ç–∞": "={{ new Date(new Date().getTime() + 3*60*60*1000).toISOString().split('T')[0] }}",
            "–í—Ä–µ–º—è": "={{ new Date(new Date().getTime() + 3*60*60*1000).toISOString().split('T')[1].substring(0, 5) }}",
            "User ID": "={{ $json.message.from.id }}",
            "Username": "={{ $json.message.from.username || '' }}",
            "–ò–º—è": "={{ $json.message.from.first_name || '' }}",
            "–°–æ–æ–±—â–µ–Ω–∏–µ": "={{ ($json.message.text || $json.message.voice ? '[–ì–æ–ª–æ—Å–æ–≤–æ–µ]' : '[–î—Ä—É–≥–æ–µ]').substring(0, 500) }}",
            "–¢–∏–ø": "={{ $json.message.voice ? '–ì–æ–ª–æ—Å–æ–≤–æ–µ' : $json.message.text ? '–¢–µ–∫—Å—Ç' : '–î—Ä—É–≥–æ–µ' }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "–î–∞—Ç–∞",
              "displayName": "–î–∞—Ç–∞",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–í—Ä–µ–º—è",
              "displayName": "–í—Ä–µ–º—è",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "User ID",
              "displayName": "User ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Username",
              "displayName": "Username",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–ò–º—è",
              "displayName": "–ò–º—è",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–°–æ–æ–±—â–µ–Ω–∏–µ",
              "displayName": "–°–æ–æ–±—â–µ–Ω–∏–µ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "–¢–∏–ø",
              "displayName": "–¢–∏–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1440,
        -928
      ],
      "id": "540a39a5-9808-4363-9acc-9621e80c4586",
      "name": "Save Message History",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "J9i793A3S5vdil3F",
          "name": "Google Sheets account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Parse Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Save Message History",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Notify Owner",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Response": {
      "main": [
        [
          {
            "node": "Extract Contacts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notify Owner": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Welcome Message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Welcome Message": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Price Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Contact Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Portfolio Response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Request Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger1": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Start Trigger1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Contacts": {
      "main": [
        [
          {
            "node": "Has Phone",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Request Response": {
      "main": [
        [
          {
            "node": "Notify Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Spam Check": {
      "main": [
        [
          {
            "node": "Is Spam",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Spam": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Phone": {
      "main": [
        [
          {
            "node": "Thank You Message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Thank You Message": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Voice": {
      "main": [
        [
          {
            "node": "Voice Reply",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Spam Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Voice Reply": {
      "main": [
        [
          {
            "node": "Spam Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Message History": {
      "main": [
        [
          {
            "node": "Is Voice",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "89e6e5ce-4dad-4726-b0f5-c5fee0257e14",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4d995f39819eae463424ce11b40cade7eb28839254b296dac1182f5eca2ccad6"
  },
  "id": "Il7jPYJQoQEcBEFv",
  "tags": []
}